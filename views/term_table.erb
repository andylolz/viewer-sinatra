<div class="page-section" id="term">
  <div class="container">
    <h1 class="text-center"><span class="avatar"><i class="fa fa-university"></i></span> <%= @term['name'] %></h1>
    <% unless @term['start_date'].to_s.empty? and @term['end_date'].to_s.empty? %>
      <p class="text-center"><%= @term['start_date'] %> – <%= @term['end_date'] %></p>
    <% end %>

    <p>
    <% if @prev_term %>
      <span><a href="<%= term_table_url(@prev_term) %>">
        <i class="fa fa-arrow-left"></i> <%= @prev_term['name'] %>
      </a></span>
    <% end %>

    <% if @next_term %>
      <span style="float:right"><a href="<%= term_table_url(@next_term) %>">
          <%= @next_term['name'] %> <i class="fa fa-arrow-right"></i>
      </a></span>
    <% end %>
    </p>

    <% if @memberships.count.zero? %>
      
    <% else %>
      <h2>Party Groupings</h2>

      <ul class="grid-list">
        <% @memberships.group_by { |m| m['on_behalf_of'] }.sort_by { |p, ms| ms.count }.reverse.each do |party, mems| %>
          <li><div class="avatar-unit">
            <span class="avatar"><i class="fa fa-users"></i></span>
            <h3><%= party['name'] %></h3>
            <p><%= mems.count %> seat<% if mems.count > 1 %>s<% end %></p>
          </div></li>
        <% end %>
      </ul>

      <h2>Members</h3>

      <table>
        <tr>
          <th>Name</th>
          <th>Group</th>
          <th>Area</th>
          <th>Dates</th>
        </tr>

      <% @memberships.group_by { |m| m['person'] }.sort_by { |p, _| p['name'] }.each do |p, mems| %>
        <tr id="mem-<%= p['id'].split('/').last %>">
          <td rowspan="<%= mems.count %>"><%= p['name'] %></td>
          <% mems.each do |m| %>
            <td><%= m['on_behalf_of']['name'] %></td>
            <td><%= m['area'] && m['area']['name'] %></td>
            <td> 
              <% if m['start_date'].to_s != @term['start_date'].to_s or m['end_date'].to_s != @term['end_date'].to_s %>
                <p><%= m['start_date'] %>–<%= m['end_date'] %></p>
              <% end %>
            </td>
          </tr>
          <% end %>
      <% end %>
      </table>

    <% end %>
    </div>
</div>
